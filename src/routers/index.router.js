const express = require("express");
const LocationDTO = require("../dtos/locationDTO.dto");
const FirestoreType = require("../enums/firestoreType.enum");
const router = express.Router();
const { createStorage } = require("../repository/storage.repository");
const { searchNearbyMeat } = require("../repository/meatLocation.repository");

router.get("/demo/upload", async (req, res) => {
  const base64String =
    "data:image/jpeg;base64,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";
  const storage = await createStorage(base64String);
  console.log(storage);
  res.status(200).send("Image successfully uploaded");
});

router.get("/demo/nearby", async (req, res) => {
  const myLocation = new LocationDTO(51.5074, 0.1277);
  const results = await searchNearbyMeat(myLocation);
  res.status(200).send(results);
});

module.exports = router;
